# ********RoostGPT********

# Test generated by RoostGPT for test vtal-product-order using AI Type Claude AI and AI Model claude-3-opus-20240229
# 
# Feature file generated for /listener/productOrderCreateEvent_post for http method type POST 
# RoostTestHash=9b45f7ab6a
# 
# 

# ********RoostGPT********
Feature: Product Order Create Event By Client

  Background:
    * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:8080')
    * url urlBase
    * def authToken = karate.properties['AUTH_TOKEN']
    * header Authorization = authToken

  Scenario: Successful product order create event notification
    Given path '/listener/productOrderCreateEvent'
    And request
      """
      {
        "notification": {
          "date": "2021-06-05T20:23:29-03:00",
          "customer": {
            "subscriberId": "12345"
          },
          "order": {
            "id": "20230315000001",
            "correlationOrder": "10",
            "associatedDocument": "VTT001",
            "type": "FTTH",
            "code": "0",
            "description": "Ordem encerrada com sucesso",
            "lostEquipment": "False"
          }
        }
      }
      """
    When method POST
    Then status 204
    And match header Content-Type contains 'application/json'

  Scenario: Invalid request body
    Given path '/listener/productOrderCreateEvent'
    And request
      """
      {
        "invalid": "body"
      }
      """
    When method POST
    Then status 400
    And match header Content-Type contains 'application/json'

  Scenario: Unauthorized request
    Given path '/listener/productOrderCreateEvent'
    And request
      """
      {
        "notification": {
          "date": "2021-06-05T20:23:29-03:00",
          "customer": {
            "subscriberId": "12345"
          },
          "order": {
            "id": "20230315000001",
            "correlationOrder": "10",
            "associatedDocument": "VTT001",
            "type": "FTTH",
            "code": "0",
            "description": "Ordem encerrada com sucesso",
            "lostEquipment": "False"
          }
        }
      }
      """
    And header Authorization = 'invalidToken'
    When method POST
    Then status 401
    And match header Content-Type contains 'application/json'

  Scenario Outline: Notification with different order codes
    Given path '/listener/productOrderCreateEvent'
    And request
      """
      {
        "notification": {
          "date": "2021-06-05T20:23:29-03:00",
          "customer": {
            "subscriberId": "12345"
          },
          "order": {
            "id": "20230315000001",
            "correlationOrder": "10",
            "associatedDocument": "VTT001",
            "type": "FTTH",
            "code": "<code>",
            "description": "<description>",
            "lostEquipment": "False"
          }
        }
      }
      """
    When method POST
    Then status 204
    And match header Content-Type contains 'application/json'

    Examples:
      | read('listener_productOrderCreateEvent_post.csv') |
